<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/delails.css">
    <script src="js/vue.js"></script>
    <link rel="stylesheet" href="css/cs.css">
    <script src="js/element.js"></script>
    <script src="js/axios.js"></script>
    <script src="js/public.js"></script>
    <script src="js/userManager.js"></script>
    <script src="js/public.js"></script>
</head>

<body>
    <div id="newer">
        <!-- 头 -->
        <header class="header">
            <!-- 顶部 -->
            <div class="topheader">
                <div class="topbarheader fr">
                    <div class="topbar">
                        <a :style="'color:'+ color+';'" @click="sendLogin">{{loginUser}}</a>
                        &nbsp;或&nbsp;
                        <a href="rigester.html">注册</a>
                        &nbsp;ANTA会员
                    </div>
                    <div class="topbar-car">
                        <div class="span" id="span1"><span id="num"></span>{{res.length}}</div>
                        <a href="cart.html" class="topbar-icon"></a>
                    </div>
                    <div class="topbar-ser" style="margin-right: 30px;">
                        <a class="topbar-icon"></a>
                    </div>
                    <div class="topbar-en">
                        <a class="topbar-icon">EN</a>
                    </div>
                </div>
            </div>


            <!-- 导航栏 -->
            <div class="nav-header">

                <!-- logo -->
                <div class="logo-header fl" style="margin-left: 126px;">
                    <div class="logo-inner">
                        <a href="index.html">
                            <img src="https://img.fishfay.com/theme/images/logo/logo-anta-r-02.svg" alt="">
                        </a>
                    </div>
                </div>

                <!-- 文字 -->
                <ul class="nav-list fr">
                    <li class="nav-item" v-for="tl in isfenlen" @click="sendourself(tl.id)">
                        <a>{{tl.title}}</a>
                    </li>

                    <li class="nav-item last">
                        <div class="nav-sear">
                            <a class="nav-btn"></a>
                            <input type="text" placeholder="搜索" autocomplete="off" class="nav-input">
                        </div>
                    </li>
                </ul>
            </div>
        </header>



        <!-- 内容 -->
        <div class="main-cont">
            <div class="page-cont">
                <div class="pro-cont w-full">
                    <div class="pro-main w-1280 clearfix">
                        <div class="pro-view fl clearfix">
                            <div class="pro-view-l fl">
                                <div class="pro-smallImgs">
                                    <div class="small-list">
                                        <ul>
                                            <!-- <li class="i">
                                        <img src="https://img.fishfay.com/shopgoods/21/112217785/112217785-2-1/26ed3b03951c397d397f489c7cb6e5e0.jpg?x-image-process=image/resize,w_220,h_220" style="display: inline;" alt="">
                                    </li>                             -->
                                        </ul>
                                    </div>
                                </div>
                                <div class="pro-oper">
                                    <a class="pro-share">分享</a>
                                    <a class="pro-collect">收藏</a>
                                </div>
                            </div>

                            <div class="pro-bigImg fl">
                                <div class="box">
                                    <div class="bigImg-box cloud" data-id="10">
                                        <img :src="girl.img" alt="">
                                        <div class="mask"></div>
                                    </div>

                                </div>
                            </div>
                            <div class="bigImg-box-e">
                                <!-- <img src="https://img.fishfay.com/shopgoods/21/112217785/112217785-2-1/26ed3b03951c397d397f489c7cb6e5e0.jpg?x-image-process=image/resize,w_800,h_800" alt=""> -->
                            </div>

                        </div>

                        <div class="pro-info fl" style="width: 485px;">
                            <div class="j_infos_t">

                            </div>
                            <div class="j_infos_b">
                                <p class="goods-color">我是渣渣灰</p>
                                <h1>{{girl.context}}</h1>
                                <h2>￥{{girl.price}}</h2>
                                <ul class="color-list">
                                    <li class="color-code">
                                        <img :src="girl.img" alt="">
                                    </li>
                                </ul>

                                <div class="infos-pane">
                                    <div class="infos-cell clearfix">
                                        <div class="half-cell goods-size-cell" style="position: relative;">
                                            <div class="chima">
                                                <ul>
                                                    <p>请选择符合您的码数</p>
                                                    <span>X</span>
                                                    <li><a>38</a></li>
                                                    <li><a>39</a></li>
                                                    <li><a>40</a></li>
                                                    <li><a>41</a></li>
                                                    <li><a>42</a></li>
                                                    <li><a>42.5</a></li>
                                                    <li><a>43</a></li>
                                                    <li><a>44</a></li>
                                                </ul>
                                            </div>
                                            <span>尺码:</span>
                                            <a>选择尺码{{csizeDisplay}}</a>
                                            <el-dropdown @command="csizeEntry">

                                                <i class="icon-right"></i>
                                                <el-dropdown-menu slot="dropdown">
                                                    <el-dropdown-item command="38">38</el-dropdown-item>
                                                    <el-dropdown-item command="39">39</el-dropdown-item>
                                                    <el-dropdown-item command="40">40</el-dropdown-item>
                                                    <el-dropdown-item command="41" disabled>41(缺货)</el-dropdown-item>
                                                    <el-dropdown-item command="42" divided>42</el-dropdown-item>
                                                </el-dropdown-menu>
                                            </el-dropdown>
                                        </div>
                                        <i class="line"></i>
                                        <div class="half-cell goods-num-cell">
                                            <div class="goods-num">
                                                <ul>
                                                    <p>请选择符合您的码数</p>
                                                    <span>X</span>
                                                    <li><a>1</a></li>
                                                    <li><a>2</a></li>
                                                    <li><a>3</a></li>
                                                    <li><a>4</a></li>
                                                    <li><a>5</a></li>
                                                </ul>
                                            </div>
                                            <span>数量:</span>
                                            <a>购买数量{{spnumDisplay}}</a>
                                            <el-dropdown @command="spnumEntry">

                                                <i class="icon-right"></i>
                                                <el-dropdown-menu slot="dropdown">
                                                    <el-dropdown-item command="1">1</el-dropdown-item>
                                                    <el-dropdown-item command="2">2</el-dropdown-item>
                                                    <el-dropdown-item command="3">3</el-dropdown-item>
                                                    <el-dropdown-item command="4">4</el-dropdown-item>
                                                    <el-dropdown-item command="5">5</el-dropdown-item>
                                                </el-dropdown-menu>
                                            </el-dropdown>
                                        </div>
                                    </div>

                                    <div class="infos-cell clearfix infos-dis">
                                        <div class="half-cell half-cell-b">
                                            <span>领取优惠券:</span>
                                            <el-dropdown>
                                                <i style="right: -10px;" class="icon-right"></i>
                                                <el-dropdown-menu slot="dropdown">
                                                    <el-dropdown-item disabled>暂无优惠</el-dropdown-item>
                                                </el-dropdown-menu>
                                            </el-dropdown>

                                        </div>
                                    </div>
                                </div>

                                <div class="goods-btn">
                                    <a @click="addCart(girl.id)" class="btn-cart goto-cart fl">加入购物车</a>
                                    <a class="btn-buy goto-cart fr" @click="send">立即购买</a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="pro-tabs w-1650">
                        <div class="pro-tab-l">
                            <p>
                                <span>
                                    商品细节
                                </span>
                            </p>
                            <i></i>
                        </div>
                        <div class="pro-tab-r">
                            <i></i>
                        </div>
                    </div>

                    <div class="pro-deta w-1280">
                        <!-- <img src="https://img.fishfay.com/shopgoods/21/112217785/bd-112217785-2-1/7de1f733b9eaa595fcf60c8a8e3360c7.jpg"  alt=""> -->
                    </div>
                </div>
            </div>
        </div>




        <!-- 尾部 -->
        <footer class="footer ">
            <div class="ft-inner w1280">
                <div class="ft-slo fl">
                    <img src="https://img.fishfay.com/theme/images/logo/slogan-anta-r.svg" alt="">
                </div>
                <div class="ft-main fr">
                    <ul class="ft-link">
                        <li>
                            <a>安踏海外</a>
                        </li>
                        <li>
                            <a>安踏投资者关系</a>
                        </li>
                    </ul>
                    <div class="ft-com" style="height: auto;">
                        <span>Copyright(C) 2020 by www.ANTA.com</span>
                        <span>©安踏体育用品有限公司版权所有</span>
                        <a>营业执照</a>
                        <a>开户许可证</a>
                        <br>
                        <a>闽ICP备11020421号-1</a>
                        <a>闽公网安备35058202000423号</a>
                    </div>
                    <ul class="ft-link">
                        <li>
                            <a>安踏儿童</a>
                        </li>
                        <li>
                            <a>Fila</a>
                        </li>
                        <li>
                            <a>Kolon Sport</a>
                        </li>
                        <li>
                            <a>Descente</a>
                        </li>
                        <li>
                            <a>Sprandi</a>
                        </li>
                        <li>
                            <a>Kingkow</a>
                        </li>
                    </ul>
                </div>
            </div>
        </footer>
    </div>

    <!-- 侧边 -->
    <div class="webcover">
        <div class="goto-top" onclick="goTop()"></div>
        <a href="cart.html" class="covercar"></a>
        <a href="customerService.html" class="coverkefu"></a>
    </div>



    <script>
        const userManager = createUserManager();
        let v = new Vue({
            el: "#newer",
            data() {
                return {
                    loginUser: null,
                    color: "",
                    num: 0,
                    pid: 0,
                    isfenlen: [{ id: 2, title: "男子" }, { id: 0, title: "女子" }, { id: 1, title: "儿童" }],
                    girl: [],
                    presets: [],
                    csizeDisplay: 0,
                    spnumDisplay: 0,
                    res: [],
                }


            },
            methods: {
                //登录
                sendLogin() {
                    if (this.loginUser != "登入") {
                    } else {
                        this.openLogin()
                    }
                },
                //进入结算
                send(id) {
                    window.location = "statement.html?pid=" + this.pid
                },
                //显示分类
                sendourself(id) {
                    document.location = "list.html?tid=" + id
                },

                //加入购物车，购物车数量加1，然后将添加的商品json保存至本地数组
                addCart(id) {
                    if (Object.keys(this.girl).length == 6) {   //判断有没有选择数量和尺寸（原始json数据长度为4）
                        if (localStorage.getItem("girl") != null) { //判断girl（购物车）是不是没有数据，有的话先取出来，然后存进数组再上传服务器
                            var b = localStorage.getItem("girl");   //定义b接收girl
                            var res = JSON.parse(b);    //定义res接收b的对象转换
                            this.res = res; //把data的res赋值为取出来的girl
                            this.num++; //已经没用了，以前是购物车总数
                            console.log(this.girl)  //懂自懂
                            for (let a of res) { //定义一个a循环res
                                if (a.id == id) {   //看看有没有重复的id
                                    this.$message({ //emui的提示
                                        type: "warning",
                                        message: "此商品已被加入购物车！请在购物车内操作！"
                                    })
                                    return
                                }
                            }


                            document.getElementById("span1").style.display = "block";   //把购物车红点的属性变为可见
                            res.push(this.girl) //把本页的girl给res
                            var a = JSON.stringify(this.res);  //定义a接收res
                            localStorage.setItem('girl', a);   //上传a，名字为girl
                            this.$message("成功加入购物车！")   //懂自懂
                        } else {//没有girl（购物车）数据则直接加数据然后存
                            // 流程和上面一样我不写了，就是直接添加上传数据不读了就
                            document.getElementById("span1").style.display = "block";
                            this.presets.push(this.girl)
                            var a = JSON.stringify(this.presets);
                            localStorage.setItem('girl', a);
                            var b = localStorage.getItem("girl");
                            var res = JSON.parse(b);
                            this.res = res;
                            this.$message("成功加入购物车！但使用的是备选方案！")
                        }
                    } else {//如果没选择规格和数量则提示
                        this.$message("请选择规格和数量");

                    }

                },

                //提示你选择了多少尺码的 并返回函数以供显示在界面上
                csizeEntry(command) {
                    this.$message('您选择了' + command + '号');

                    Vue.set(this.girl, 'csize', Number(command));

                    this.csizeDisplay = command
                    return this.csizeDisplay;
                },

                //提示你购买了几个 并返回函数以供显示在界面上
                spnumEntry(command) {
                    this.$message('您选择购买' + command + '个');
                    Vue.set(this.girl, 'spnum', Number(command));
                    this.spnumDisplay = command;
                    return this.spnumDisplay;
                }

            },
            mounted() {
                const url = window.location.href;
                const params = url.split("?")[1];
                this.pid = params.split("=")[1];
                //一个读取json的方法
                axios.get("json/details.json").then((a) => {
                    for (let girl of a.data) {
                        if (girl.id == this.pid) {
                            this.girl = girl;

                        }
                    }
                });
                //判断有没有登录，后加的方法
                if (userManager.loginUser) {
                    this.color = "red"
                    this.loginUser = "欢迎" + userManager.loginUser.phone;
                } else {
                    this.loginUser = "登入"
                }

                //计算购物车数量,使其能更好的判断是否在界面上显示
                if (localStorage.getItem("girl") != null) {
                    document.getElementById("span1").style.display = "block";
                    var a = localStorage.getItem("girl");
                    var res = JSON.parse(a);
                    this.res = res;

                } else {
                    console.log("不存在购物车，购物车个数隐藏");
                }
            },
        })
    </script>

</body>

</html>